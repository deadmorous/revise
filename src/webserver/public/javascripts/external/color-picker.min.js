/*
ReVisE: Remote visualization environment for large datasets
Copyright (C) 2021 Stepan Orlov, Alexey Kuzin, Alexey Zhuravlev, Vyacheslav Reshetnikov, Egor Usik, Vladislav Kiev, Andrey Pyatlin

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see https://www.gnu.org/licenses/agpl-3.0.en.html.

*/

/*!
 * ==============================================================
 *  COLOR PICKER 2.1.5
 * ==============================================================
 * Author: Taufik Nurrohman <https://github.com/taufik-nurrohman>
 * License: MIT
 * --------------------------------------------------------------
 */
!function(n,t,e){var r,i=t.documentElement,o="HEX",u="top",c="right",a="left",f="px",s=n.setTimeout,l=["touchstart","mousedown"],v=["touchmove","mousemove"],d=["orientationchange","resize"],h=["touchend","mouseup"];function p(n){var t,e,r,i,o,u,c,a,f=+n[0],s=+n[1],l=+n[2];switch(u=l*(1-s),c=l*(1-(o=6*f-(i=Math.floor(6*f)))*s),a=l*(1-(1-o)*s),i=i||0,c=c||0,a=a||0,i%6){case 0:t=l,e=a,r=u;break;case 1:t=c,e=l,r=u;break;case 2:t=u,e=l,r=a;break;case 3:t=u,e=c,r=l;break;case 4:t=a,e=u,r=l;break;case 5:t=l,e=u,r=c}return[O(255*t),O(255*e),O(255*r),x(n[3])?+n[3]:1]}function g(n){var t,e=+n[0]/255,r=+n[1]/255,i=+n[2]/255,o=Math.max(e,r,i),u=Math.min(e,r,i),c=o,a=o-u,f=0===o?0:a/o;if(o===u)t=0;else{switch(o){case e:t=(r-i)/a+(r<i?6:0);break;case r:t=(i-e)/a+2;break;case i:t=(e-r)/a+4}t/=6}return[t,f,c,x(n[3])?+n[3]:1]}function b(n,t){var e=t.touches?t.touches[0].clientX:t.clientX,r=t.touches?t.touches[0].clientY:t.clientY,i=C(n);return[e-i[0],r-i[1]]}function m(n,t){if(n===t)return n;for(;(n=n.parentElement)&&n!==t;);return n}function C(t){var e,r,o;return t===n?(e=n.pageXOffset||i.scrollLeft,r=n.pageYOffset||i.scrollTop):(e=(o=t.getBoundingClientRect()).left,r=o.top),[e,r]}function k(t){return t===n?[n.innerWidth,n.innerHeight]:[t.offsetWidth,t.offsetHeight]}function y(n){n&&n.preventDefault()}function w(n){return"function"==typeof n}function x(n){return void 0!==n&&null!==n}function E(n){return"string"==typeof n}function P(n,t){return n<t[0]?t[0]:n>t[1]?t[1]:n}function H(n,t){return parseInt(n,t||10)}function M(n,e,r){return n=t.createElement(n),e&&e.appendChild(n),r&&(n.className=r),n}function O(n){return Math.round(n)}function X(n,t){return n.toString(t)}function j(n,t,e){for(var r=0,i=t.length;r<i;++r)n.removeEventListener(t[r],e,!1)}function L(n,t,e){for(var r=0,i=t.length;r<i;++r)n.addEventListener(t[r],e,!1)}function Y(n,t,e){n.style[t]=e}(r=n.CP=function(e,r){if(e){var H=this,O=n.CP,X={},I=Object.assign({},O.state,E(r)?{color:r}:r||{}),N=I.class,T=M("div",0,N);if(e.CP)return H;if(!(H instanceof O))return new O(e,r);O.instances[e.id||e.name||Object.keys(O.instances).length]=H,e.CP=1,H.visible=!1;var W,$,z,B,D=t.body,R=on(),S=g(R),q=M("div",T),A=M("div",q,N+":sv"),F=M("div",q,N+":h"),G=M("div",q,N+":a"),J=M("div",A),K=(M("div",A),M("div",A),M("i",A)),Q=(M("div",F),M("i",F)),U=M("div",G),V=(M("div",G),M("i",G)),Z=0,_=0,nn=0,tn=0,en=0,rn=0;!function r(o,w){S=g(R=on()),o||((w||I.parent||D).appendChild(T),H.visible=!0),W=function(n){return r(0,n),un("enter",R),H},$=function(){var e=cn();return e&&(e.removeChild(T),H.current=null,H.visible=!1),j(A,l,gn),j(F,l,bn),j(G,l,mn),j(t,v,hn),j(t,h,pn),j(n,d,B),un("exit",R),H},z=function(t){var r=k(n),o=k(i),c=r[0]-o[0],s=r[1]-i.clientHeight,l=C(n),v=C(e),d=k(T),h=d[0],p=d[1],g=v[0]+l[0],b=v[1]+l[1]+k(e)[1];if("object"==typeof t)x(t[0])&&(g=t[0]),x(t[1])&&(b=t[1]);else{var m=l[0],y=l[1],w=l[0]+r[0]-h-c,E=l[1]+r[1]-p-s;g=P(g,[m,w])>>0,b=P(b,[y,E])>>0}return Y(T,a,g+f),Y(T,u,b+f),un("fit",R),H},B=function(){return z()};var E=k(A),M=E[0],O=E[1],N=k(K),q=N[0],fn=N[1],sn=k(F)[1],ln=k(Q)[1],vn=k(G)[1],dn=k(V)[1];function hn(n){tn&&function(n){var t=b(A,n),e=P(t[0],[0,M]),r=P(t[1],[0,O]);S[1]=1-(M-e)/M,S[2]=(O-r)/O,Cn()}(n),en&&function(n){S[0]=(sn-P(b(F,n)[1],[0,sn]))/sn,Cn()}(n),rn&&function(n){S[3]=(vn-P(b(G,n)[1],[0,vn]))/vn,Cn()}(n),R=p(S),(tn||en||rn)&&(un(Z||_||nn?"start":"drag",R),un("change",R)),Z=_=nn=0}function pn(n){R=p(S);var t=n.target,r=e===m(t,e),i=T===m(t,T);H.current=null,r||i?i&&(tn||en||rn)&&un("stop",R):X.blur?un("blur",R):cn()&&$(),tn=en=rn=0}function gn(n){H.current=A,Z=tn=1,hn(n),y(n)}function bn(n){H.current=F,_=en=1,hn(n),y(n)}function mn(n){H.current=G,nn=rn=1,hn(n),y(n)}function Cn(){var n;x((n=S)[1])&&Y(K,c,M-q/2-M*+n[1]+f),x(n[2])&&Y(K,u,O-fn/2-O*+n[2]+f),x(n[0])&&Y(Q,u,sn-ln/2-sn*+n[0]+f),x(n[3])&&Y(V,u,vn-dn/2-vn*+n[3]+f);var t=p(S),e=p([S[0],1,1]);Y(J,"backgroundColor","rgb("+e[0]+","+e[1]+","+e[2]+")"),Y(U,"backgroundImage","linear-gradient(rgb("+t[0]+","+t[1]+","+t[2]+"),transparent)")}o?(L(e,l,an),s(function(){un("change",R)},1)):(L(A,l,gn),L(F,l,bn),L(G,l,mn),L(t,v,hn),L(t,h,pn),L(n,d,B),z()),H.get=function(){return on()},H.set=function(n,t,e,r){return S=g([n,t,e,r]),Cn(),H},Cn()}(1),H.color=function(n,t,e,r){return O[w(O[I.color])?I.color:o]([n,t,e,r])},H.current=null,H.enter=W,H.exit=$,H.fire=un,H.fit=z,H.hooks=X,H.off=function(n,t){if(!x(n))return X={},H;if(x(X[n]))if(x(t)){for(var e=0,r=X[n].length;e<r;++e)t===X[n][e]&&X[n].splice(e,1);0===r&&delete X[n]}else delete X[n];return H},H.on=function(n,t){return x(X[n])||(X[n]=[]),x(t)&&X[n].push(t),H},H.pop=function(){return e.CP?(delete e.CP,j(e,l,an),$(),un("pop",R)):H},H.value=function(n,t,e,r){return H.set(n,t,e,r),un("change",[n,t,e,r])},H.self=T,H.source=e,H.state=I}function on(n){var t,r=O[w(O[I.color])?I.color:o];return(t=e.dataset.color)?x(n)?e.dataset.color=r(t):r(t):(t=e.value)?x(n)?e.value=r(t):r(t):(t=e.textContent)?x(n)?e.textContent=r(t):r(t):x(n)?void 0:[0,0,0,1]}function un(n,t){if(!x(X[n]))return H;for(var e=0,r=X[n].length;e<r;++e)X[n][e].apply(H,t);return H}function cn(){return T.parentNode}function an(n){if(X.focus)un("focus",R);else{var t=n.target;e===m(t,e)?!cn()&&W(I.parent):$()}}}).version="2.1.5",r.state={class:"color-picker",color:o,parent:null},r.instances={},r[o]=function(n){if(E(n)){var t=(n=n.trim()).length;if(4!==t&&7!==t||"#"!==n[0]){if((5===t||9===t)&&"#"===n[0]&&/^#([a-f\d]{3,4}){1,2}$/i.test(n))return 5===t?[H(n[1]+n[1],16),H(n[2]+n[2],16),H(n[3]+n[3],16),H(n[4]+n[4],16)/255]:[H(n[1]+n[2],16),H(n[3]+n[4],16),H(n[5]+n[6],16),H(n[7]+n[8],16)/255]}else if(/^#([a-f\d]{3}){1,2}$/i.test(n))return 4===t?[H(n[1]+n[1],16),H(n[2]+n[2],16),H(n[3]+n[3],16),1]:[H(n[1]+n[2],16),H(n[3]+n[4],16),H(n[5]+n[6],16),1];return[0,0,0,1]}return"#"+("000000"+X(+n[2]|+n[1]<<8|+n[0]<<16,16)).slice(-6)+(x(n[3])&&n[3]<1?X(O(255*n[3])+65536,16).substr(-2):"")}}(window,document);
